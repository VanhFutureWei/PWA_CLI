#!/usr/bin/expect -f
#
# This Expect script was generated by autoexpect on Mon Aug  8 15:48:50 2022
# Expect and autoexpect were both written by Don Libes, NIST.
#
# Note that autoexpect does not guarantee a working script.  It
# necessarily has to guess about certain things.  Two reasons a script
# might fail are:
#
# 1) timing - A surprising number of programs (rn, ksh, zsh, telnet,
# etc.) and devices discard or ignore keystrokes that arrive "too
# quickly" after prompts.  If you find your new script hanging up at
# one spot, try adding a short sleep just before the previous send.
# Setting "force_conservative" to 1 (see below) makes Expect do this
# automatically - pausing briefly before sending each character.  This
# pacifies every program I know of.  The -c flag makes the script do
# this in the first place.  The -C flag allows you to define a
# character to toggle this mode off and on.

set force_conservative 0  ;# set to 1 to force conservative mode even if
			  ;# script wasn't run conservatively originally
if {$force_conservative} {
	set send_slow {1 .1}
	proc send {ignore arg} {
		sleep .1
		exp_send -s -- $arg
	}
}

#
# 2) differing output - Some programs produce different output each time
# they run.  The "date" command is an obvious example.  Another is
# ftp, if it produces throughput statistics at the end of a file
# transfer.  If this causes a problem, delete these patterns or replace
# them with wildcards.  An alternative is to use the -p flag (for
# "prompt") which makes Expect only look for the last line of output
# (i.e., the prompt).  The -P flag allows you to define a character to
# toggle this mode off and on.
#
# Read the man page for more info.
#
# -Don


set timeout -1
spawn ./pkg_ch.sh
match_max 100000
expect -exact "\[H\[2J\[3J \r
------------------------------------------------------------------------------------ \r
this script will detect the Node.JS and npm present in your system\r
it's also check to see if they meet the requirement of Node.js version 12.0 or above\r
When running Bubblewrap for the first time\r
it will offer to automatically download and install external dependencies\r
-------------------------------------------------------------------------------------\r
 \r
Today is: Mon Aug  8 15:48:50 PDT 2022 \r
 \r
your bash version is: GNU bash, version 5.1.16(1)-release (x86_64-pc-linux-gnu)\r
Copyright (C) 2020 Free Software Foundation, Inc.\r
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\r
\r
This is free software; you are free to change and redistribute it.\r
There is NO WARRANTY, to the extent permitted by law.\r
 \r
your bash path is: /usr/bin/bash\r
checking your node.js version\r
the value is: v18.4.0 \r
your current node version is: v18.4.0\r
your Node.js is: v18.4.0\r
major: 18\r
minor: 4\r
You are good to go\r
create Android project...\r
looking for your manifest \r
no manifest.json file on your system\r
Since you don't have the manifest. I will create one for you\r
 I'm creating simple manifest base on host URL ...\r
Installing bubblewrap command line...\r
the manifest is: https://sadchonks.com/manifest.json\r
generating Android project for you\r
Unable to load the \"svg2img\" library. SVGs are not supported\r
\[35m,-----.        ,--.  ,--.  ,--.\[39m\r
\[35m|  |) /_,--.,--|  |-.|  |-.|  |,---.,--.   ,--,--.--.,--,--.,---.\[39m\r
\[35m|  .-.  |  ||  | .-. | .-. |  | .-. |  |.'.|  |  .--' ,-.  | .-. |\[39m\r
\[35m|  '--' '  ''  | `-' | `-' |  \\   --|   .'.   |  |  \\ '-'  | '-' '\[39m\r
\[35m`------' `----' `---' `---'`--'`----'--'   '--`--'   `--`--|  |-'\[39m\r
\[35m                                                           `--'    \[39m\r
Initializing application from Web Manifest:\r
	-  \[36mtrue\[39m\r
\r
\r
\[7mcli\[0m \[31mERROR Cannot read properties of undefined (reading 'startsWith')\[0m\r
\r
\r
Unable to load the \"svg2img\" library. SVGs are not supported\r
\[35m,-----.        ,--.  ,--.  ,--.\[39m\r
\[35m|  |) /_,--.,--|  |-.|  |-.|  |,---.,--.   ,--,--.--.,--,--.,---.\[39m\r
\[35m|  .-.  |  ||  | .-. | .-. |  | .-. |  |.'.|  |  .--' ,-.  | .-. |\[39m\r
\[35m|  '--' '  ''  | `-' | `-' |  \\   --|   .'.   |  |  \\ '-'  | '-' '\[39m\r
\[35m`------' `----' `---' `---'`--'`----'--'   '--`--'   `--`--|  |-'\[39m\r
\[35m                                                           `--'    \[39m\r
Initializing application from Web Manifest:\r
	-  \[36mhttps://sadchonks.com/manifest.json\[39m\r
\[1m\[33mWARNING: \[39m\[22mTrusted Web Activities are currently incompatible with applications\r
targeting children under the age of 13. Check out the Play for Families\r
policies to learn more.\r
\[36mhttps://play.google.com/console/about/families/\[39m\r
\[4m\[24m\r
\[4mWeb app details \[32m(1/5)\[39m\[24m\r
\r
The application generated by Bubblewrap will open a Progressive Web App when\r
started from the Android launcher. Please enter the following details about\r
the PWA:\r
  \r
	- \[1mDomain:\[22m the domain / origin where the PWA is hosted. \r
	  Example: \[36mexample.com\[39m\r
\r
	- \[1mURL path:\[22m an URL path relative to the root of the origin,\r
	  opened when the application is started from the home screen.\r
	  Examples:\r
\r
		- To open \[3mhttps://example.com/\[23m: \[36m/\[39m\r
		- To open \[3mhttps://example.com/path-to-pwa/\[23m: \[36m/path-to-pwa/\[39m\r
\r
\[32m?\[39m \[1mDomain:\[22m\[0m \[0m\[2m(sadchonks.com) \[22m\[26D\[26C"
send -- "sadchonks.com\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mDomain:\[22m\[0m \[0m\[36msadchonks.com\[39m\[23D\[23C\r
\[32m?\[39m \[1mURL path:\[22m\[0m \[0m\[2m(/saved) \[22m\[21D\[21C"
send -- "\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mURL path:\[22m\[0m \[0m\[36m/saved\[39m\[18D\[18C\r
\[4m\[24m\r
\[4mAndroid app details \[32m(2/5)\[39m\[24m\r
\r
Please, enter details regarding how the Android app will look when installed\r
into a device:\r
\r
	- \[1mApplication name:\[22m the name used in most places,\r
	  including the App information screen and on the Play Store.\r
\r
	- \[1mShort name:\[22m an alternate name for the app, limited to\r
	  12 characters, used on a device launch screen.\r
\r
	- \[1mApplication ID:\[22m also known as \[3mPackage Name\[23m, this is\r
	  the unique identifier for the application on an Android device or\r
	  the Play Store. The name must contain at least two segments,\r
	  separated by dots, each segment must start with a letter and all\r
	  characters must be alphanumeric or an underscore (_).\r
\r
	- \[1mDisplay mode:\[22m how the app will be displayed on the\r
	  device screen when started. The default mode, used by most apps,\r
	  is \[36mstandalone\[39m. \[36mfullscreen\[39m causes the device status bar and\r
	  navigation bars to be removed and is suitable for games or media\r
	  players. For more information on the status bars and navigation\r
	  bar on Android, go to:\r
	   - \[36mhttps://material.io/design/platform-guidance/android-bars.html\[39m.\r
\r
	- \[1mStatus bar color:\[22m sets the status bar color used when the\r
	  application is in foreground. Example: \[36m#7CC0FF\[39m\r
\r
\[32m?\[39m \[1mApplication name:\[22m\[0m \[0m\[2m(Sad Chonks) \[22m\[33D\[33C"
send -- "\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mApplication name:\[22m\[0m \[0m\[36mSad Chonks\[39m\[30D\[30C\r
\[32m?\[39m \[1mShort name:\[22m\[0m \[0m\[2m(Chonks) \[22m\[23D\[23C"
send -- "\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mShort name:\[22m\[0m \[0m\[36mChonks\[39m\[20D\[20C\r
\[32m?\[39m \[1mApplication ID:\[22m\[0m \[0m\[2m(com.sadchonks.twa) \[22m\[38D\[38C"
send -- "\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mApplication ID:\[22m\[0m \[0m\[36mcom.sadchonks.twa\[39m\[35D\[35C\r
\[32m?\[39m \[1mStarting version code for the new app version:\[22m\[0m \[0m\[2m(1) \[22m\[53D\[53C"
send -- "\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mStarting version code for the new app version:\[22m\[0m \[0m\[36m1\[39m\[50D\[50C\r
\[?25l\[32m?\[39m \[1mDisplay mode:\[22m\[0m \[0m\[2m(Use arrow keys)\[22m\r
\[36m‚ùØ standalone\[39m \r
  fullscreen \r
  fullscreen-sticky \[20D\[20C"
send -- "\r"
expect -exact "\[2K\[1A\[2K\[1A\[2K\[1A\[2K\[G\[32m?\[39m \[1mDisplay mode:\[22m\[0m \[0m\[36mstandalone\[39m\[26D\[26C\r
\[?25h\[?25l\[32m?\[39m \[1mOrientation:\[22m\[0m \[0m\[2m(Use arrow keys)\[22m\r
\[36m‚ùØ default\[39m \r
  any \r
  natural \r
  landscape \r
  portrait \r
  portrait-primary \r
  portrait-secondary \r
\[2m(Move up and down to reveal more choices)\[22m\[41D\[41C"
send -- "\r"
expect -exact "\[2K\[1A\[2K\[1A\[2K\[1A\[2K\[1A\[2K\[1A\[2K\[1A\[2K\[1A\[2K\[1A\[2K\[G\[32m?\[39m \[1mOrientation:\[22m\[0m \[0m\[36mdefault\[39m\[22D\[22C\r
\[?25h\[32m?\[39m \[1mStatus bar color:\[22m\[0m \[0m\[2m(#3F51B5) \[22m\[30D\[30C"
send -- "\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mStatus bar color:\[22m\[0m \[0m\[36m#3F51B5\[39m\[27D\[27C\r
\[4m\[24m\r
\[4mLauncher icons and splash screen \[32m(3/5)\[39m\[24m\r
\r
The Android app requires an image for the launcher icon. It also displays a\r
splash screen while the web content is loading, to avoid displaying a flash of\r
a blank white page to users. \r
\r
	- \[1mSplash screen color:\[22m sets the background colour used for the\r
	  splash screen. Example: \[36m#7CC0FF\[39m\r
\r
	- \[1mIcon URL:\[22m URL to an image that is at least 512x512px. Used to\r
	  generate the launcher icon for the application and the image for\r
	  the splash screen.\r
\r
	- \[1mMaskable Icon URL (Optional):\[22m URL to an image that is at least\r
	  512x512px to be used when generating maskable icons. Maskable\r
	  icons should look good when their edges are removed by an icon\r
	  mask. They will be used to display adaptive launcher icons on the\r
	  Android home screen.\r
\r
\[32m?\[39m \[1mSplash screen color:\[22m\[0m \[0m\[2m(#3F51B5) \[22m\[33D\[33C"
send -- "\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mSplash screen color:\[22m\[0m \[0m\[36m#3F51B5\[39m\[30D\[30C\r
\[32m?\[39m \[1mIcon URL:\[22m\[0m \[0m\[2m(https://sadchonks.com/kitteh-512.png) \[22m\[51D\[51C"
send -- "\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mIcon URL:\[22m\[0m \[0m\[36mhttps://sadchonks.com/kitteh-512.png\[39m\[48D\[48C\r
\[32m?\[39m \[1mMaskable icon URL:\[22m\[0m \[0m\[2m() \[22m\[24D\[24C"
send -- "\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mMaskable icon URL:\[22m\[0m \[0m\[21D\[21C\r
\[4m\[24m\r
\[4mOptional Features \[32m(4/5)\[39m\[24m\r
\r
	- \[1mInclude app shortcuts:\[22m This question is only prompted if a\r
	  'shortcuts' section is available on the input Web Manifest. When\r
	  answered ‚Äúyes‚Äù, Bubblewrap uses the information to generate\r
	  shortcuts on the Android app. Read more about app shortcuts at\r
	  \[36mhttps://web.dev/app-shortcuts/\[39m.\r
\r
	- \[1mMonochrome icon URL:\[22m URL to an image that is at least 48x48px to\r
	  be used when generating monochrome icons. Monochrome icons should\r
	  look good when displayed with a single color, the PWA's\r
	  \[3mtheme_color\[23m. They will be used for notification icons.\r
\r
\[32m?\[39m \[1mInclude app shortcuts?\[22m\[0m \[0m\[2m(Y/n) \[22m\[31D\[31C"
send -- "\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mInclude app shortcuts?\[22m\[0m \[0m\[36mYes\[39m\[28D\[28C\r
\[32m?\[39m \[1mMonochrome icon URL:\[22m\[0m \[0m\[2m() \[22m\[26D\[26C"
send -- "\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mMonochrome icon URL:\[22m\[0m \[0m\[23D\[23C\r
\[32m?\[39m \[1mInclude support for Play Billing (this relies on alpha dependencies)?\[22m\[0m \[0m\[2m(y/N) \[22m\[78D\[78C"
send -- "\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mInclude support for Play Billing (this relies on alpha dependencies)?\[22m\[0m \[0m\[36mNo\[39m\[74D\[74C\r
\[32m?\[39m \[1mRequest geolocation permission?\[22m\[0m \[0m\[2m(y/N) \[22m\[40D\[40C"
send -- "\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mRequest geolocation permission?\[22m\[0m \[0m\[36mNo\[39m\[36D\[36C\r
\[4m\[24m\r
\[4mSigning key information \[32m(5/5)\[39m\[24m\r
\r
Please, enter information about the key store containing the keys that will be used\r
to sign the application. If a key store does not exist on the provided path,\r
Bubblewrap will prompt for the creation of a new keystore.\r
\r
	- \[1mKey store location:\[22m The location of the key store in the file\r
	  system.\r
\r
	- \[1mKey name:\[22m The alias used on the key.\r
\r
Read more about Android signing keys at:\r
	 \[36mhttps://developer.android.com/studio/publish/app-signing\[39m\r
\r
\[32m?\[39m \[1mKey store location:\[22m\[0m \[0m\[2m(/home/vanh/android.keystore) \[22m\[52D\[52C"
send -- "\r"
expect -exact "\[2K\[G\[32m?\[39m \[1mKey store location:\[22m\[0m \[0m\[36m/home/vanh/android.keystore\[39m\[49D\[49C\r
\[32m?\[39m \[1mKey name:\[22m\[0m \[0m\[2m(android) \[22m\[22D\[22C"
send -- "\r"
expect eof
